<!doctype html><html><head>
  <meta charset="utf-8">
  <link rel="icon" href="img/favicon.ico" type="image/x-icon">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ECAM v3</title>

  <!--load css-->
  <link rel="stylesheet" href="css.css">
  <link rel="stylesheet" href="css_components.css">

  <!--libs-->
    <!--string compression lib -->
    <script src="js/lz-string.js"></script>
    <!--google charts lib-->
    <script src="js/charts/loader.js"></script>
    <!--vue js lib
      development version, includes helpful console warnings
      <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
      production version, optimized for size and speed
      <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <!--/libs-->

  <!--backend-->
    <!--Languages-->
    <script src="languages/translate.js"></script>

    <!--Data Model-->
    <script src="dataModel/structure.js"></script>
    <script src="dataModel/global.js"></script>
    <script src="dataModel/substages.js"></script>
    <script src="dataModel/info.js"></script>
    <script src="dataModel/level3variables.js"></script>
    <script src="dataModel/level2only.js"></script>
    <script src="dataModel/questions.js"></script>
    <script src="dataModel/formulas.js"></script>
    <script src="dataModel/units.js"></script>
    <script src="dataModel/tables.js"></script>
    <script src="dataModel/refValues.js"></script>
    <script src="dataModel/exceptions.js"></script>
    <script src="dataModel/normalization.js"></script>
    <script src="dataModel/constants.js"></script>
    <script src="dataModel/tips.js"></script>
    <script src="dataModel/countries.js"></script>
    <script src="dataModel/gwp_reports.js"></script>
    <script src="dataModel/estimations.js"></script>
    <script src="dataModel/sumable_magnitudes.js"></script>
    <script src="dataModel/recommendations.js"></script>

    <!--cookies-->
    <script src="js/cookies.js"></script>
    <script src="js/updateGlobalFromCookies.js"></script>

    <script src="utils.js"></script>
    <!--graphs--><script src="graphs.js"></script>
    <!--unfccc--><script src="dataModel/unfccc.js"></script>

    <!--new open save clear functions-->
    <script src=main_menu.js></script>
  <!--/backend-->
</head><body>

<!--ecam logo-->
<div id="ecam-logo">
  <!--menu symbol-->
  <div id=burger onclick="event.stopPropagation();sidebar.visible^=1">
    &#9776;
  </div>

  <!--logo-->
  <div id=logo_container>
    <a onclick="ecam.views.show('index')" class=flex tabindex=-1
      style='outline:none'
    >
      <div><b id=logo>ECAM</b></div>
      <div>{{translate('navbar_title')}}</div>
    </a>
  </div>

  <!--version-->
  <div style="font-family:monospace">
    <a href="//github.com/icra/ecam" target=_blank>
      {{version}}
    </a>
  </div>

  <!--language-->
  <div>
    <div id=lang>
      <!--current language-->
      <img :src=`img/flags/${Languages.current}.png`>

      <!--all languages-->
      <div id=select> 
        <div
          v-for="lang in Languages.list"
          :lang="lang"
          @click="Languages.current=lang"
        >
          <img :src=`img/flags/${lang}.png`>
          {{lang}}
        </div>

        <!--arabic
        <div lang=ar onclick="alert('')">
          <img src="img/flags/ar.png">
          ar
        </div>
        -->

        <!--null (only language tags)-->
        <div lang=null @click="Languages.current='null'">
          <img src="img/flags/null.png">
          null (tags only)
        </div>

        <!--language problem finder-->
        <div :lang="Languages.current">
          <a href=translation_problems.php style=color:blue>
            language debugging tool
          </a>
        </div>
      </div> 
    </div>
  </div>
</div>

<!--sidebar-->
<div id=sidebar v-if="visible">
  <div class="header flex" style="padding:5px;justify-content:space-between">
    <div>{{translate("sidebar_mainMenu")}}</div>
    <div>{{Global.General.Name}}          </div>
  </div>

  <!--new open save clear-->
  <div class=tab_buttons>
    <button class=left onclick="">
      {{translate('new')}}
    </button>
    <button class=middle onclick="">
      {{translate('open')}}
    </button>
    <button class=middle onclick="">
      {{translate('save')}}
    </button>
    <button class=right onclick="">
      {{translate('clear')}}
    </button>
    <input type="file" id="loadfile" accept=".json"
      onchange="loadFile(event)" style="display:none">
  </div>

  <!--sections-->
  <ul>
    <!--from start to tier A-->
    <li class=section>
      <div class=header>{{translate('main')}}</div>
      <ul>
        <li class=item><a onclick="event.stopPropagation();ecam.views.show('get_started')">{{translate('getStarted_general_info')}}</a>
        <li class=item><a onclick="event.stopPropagation();ecam.views.show('configuration')">{{translate('configuration')          }}</a>
        <li class=item><a onclick="event.stopPropagation();ecam.views.show('population')">{{translate('population')             }}</a>
        <li class=item><a onclick="event.stopPropagation();ecam.views.show('tier_a')">{{translate('quick_assessment')       }}</a>
      </ul>
    </li>

    <!--tier B-->
    <li class=section>
      <div class=header>{{translate('energy_performance')}}</div>
      <ul>
        <li
          class=item
          v-for="l1 in Structure.filter(s=>!s.sublevel).filter(s=>Global.Configuration.ActiveStages[s.alias])"
        >
          <a onclick :style=`color:${l1.color}`>
            {{translate(l1.level)}}
          </a>

          <ul>
            <li
              class=item-l2
              v-for="l2 in Structure
                            .filter(s=>(s.sublevel && s.level==l1.level))
                            .filter(s=>Global.Configuration.ActiveStages[s.alias])"
            >
              <a onclick
                :style=`color:${l1.color}`
              >
                {{translate(l2.sublevel)}}
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </li>

    <!--summaries-->
    <li class=section>
      <div class=header>{{translate('summaries')}}</div>
      <ul>
        <li class=item><a onclick="ecam.views.show('sources')">        {{translate('ghg_summary')      }}</a>
        <li class=item><a onclick="ecam.views.show('energy_summary')"> {{translate('nrg_summary')      }}</a>
        <li class=item><a onclick="ecam.views.show('unfcc')">          {{translate('unfccc_categories')}}</a>
        <li class=item><a onclick="ecam.views.show('substages')">      {{translate('all_substages')    }}</a>
        <li class=item><a onclick="ecam.views.show('summary')">        {{translate('all_inputs')       }}</a>
        <li class=item><a onclick="ecam.views.show('summary')">        {{translate('all_outputs')      }}</a>
        <li class=item><a onclick="ecam.views.show('summary')">        {{translate('all_ccvv')         }}</a>
        <li class=item><a onclick="ecam.views.show('questions')">      {{translate('All questions')    }}</a>
        <li class=item><a onclick="ecam.views.show('constants')">      {{translate('all_constants')    }}</a>
        <li class=item><a onclick="ecam.views.show('benchmark')">      {{translate('all_benchmarks')   }}</a>
      </ul>
    </li>

    <!--other-->
    <li class=section>
      <div class=header>{{translate('other')}}</div>
      <ul>
        <li class=item><a onclick="ecam.views.show('opps')">       {{translate("opportunities") }}</a>
        <li class=item><a onclick="ecam.views.show('export')">     {{translate('sidebar_export')}}</a>
        <li class=item><a onclick="ecam.views.show('sankey')">     {{translate('Sankey diagram')}}</a>
        <li class=item><a onclick="ecam.views.show('development')">{{translate('dev')}}           </a>
      </ul>
    </li>
  </ul>

  <!--for development-->
  <div>
    <button @click=visible^=1>close</button>
  </div>
</div>

<!--linear top menu-->
<div id=linear-menu v-if="visible" class=flex>
  <!--general info-->
  <div onclick="ecam.views.show('get_started')">
    <div>
      <a style="color:inherit">
        {{translate('getStarted_general_info')}}
      </a>
    </div>
    <img class=l1 src=img/getStarted.png :caption="translate('getStarted_general_info')">
  </div>

  <!--configuration-->
  <div onclick="ecam.views.show('configuration')">
    <div>
      <a style="color:inherit">
        {{translate('configuration')}}
      </a>
    </div>
    <img class=l1 src=img/dashboard.png :caption="translate('configuration')">
  </div>

  <!--population-->
  <div onclick="ecam.views.show('population')">
    <div>
      <a style="color:inherit">
        {{translate('population')}}
      </a>
    </div>
    <img class=l1 src=img/inhabitants.png :caption="translate('population')">
  </div>

  <!--tier A-->
  <div>
    <div>
      <a style="color:inherit" v-html="translate('tier_A')"></a>
    </div>
    <img class=l1 src=img/birds.png :caption="translate('tier_A')">
  </div>

  <!--tier B-->
  <div>
    <div>
      <span style="color:inherit"
        v-html="translate('tier_B')"
      ></span>
    </div>
    <img v-for="l2 in Structure.filter(s=>s.sublevel)"
      class=l2
      :stage="l2.alias"
      :caption="translate(l2.sublevel)"
      :src="`img/${l2.alias}${Global.Configuration.ActiveStages[l2.alias]?'':'-off'}.png`"
      @click="go_to_edit(l2)"
    >
  </div>

  <!--summaries and opps-->
  <div class=flex>
    <!--Summaries-->
    <div>
      <div>
        <span style="color:inherit">
          {{translate('summaries')}}
        </span>
      </div>
      <img class=l1 src=img/sources.png :caption="translate('ghg_summary')">
      <img class=l1 src=img/energy.png  :caption="translate('nrg_summary')">
    </div>

    <!--Opportunities-->
    <div>
      <div>
        <a style="color:inherit">
          {{translate('opportunities')}}
        </a>
      </div>
      <img class=l1 src=img/opps.png :caption="translate('opportunities')">
    </div>
  </div>
</div>

<!--index-->
<div id=index v-if="visible">
  <div id=content>
    <!--new title-->
    <div class="width_50">
      <h1 class="blue_h1" style=padding-bottom:0px>
        {{translate("a_toolkit_for_utilities")}}
      </h1>
      <h1 class="green_h1" style=font-size:32px>
        {{translate("assess_your_utility")}}
      </h1>

      <!--new text-->
      <h4 style=font-size:18px;color:#58595b>
        {{translate("index_description")}}
      </h4>
      <h4 style=font-size:18px;color:#58595b>
        {{translate("ecam_is_a_free_and")}}
        <a target=_blank href=//github.com/icra/ecam>
          {{translate("open_source")}}
        </a>
        {{translate("tool_developed_as_part_of_the")}}
        <a target=_blank href=//wacclim.org/>
          {{translate("wacclim_project")}}
        </a>
      </h4>
      <h4 style=font-size:18px;color:#58595b>
        {{translate("first_time_using_ecam")}}
        <a href=help.php target=_blank>
          {{translate("here")}}.
        </a>
      </h4>

      <!--MENU BUTTONS-->
      <div style="padding:1em 0">
        <div class=flex id=menu_buttons>
          <!--new-->
          <div>
            <button class="button add" onclick=newSystem() style=margin-left:0>
              {{translate('new')}}
            </button>
          </div>

          <!--load/open-->
          <div>
            <input type=file
              id=loadfile
              accept=".json"
              onchange="loadFile(event)"
              style=display:none
            >
            <button class="button edit"
              onclick=document.getElementById('loadfile').click()>
              {{translate('open')}}
            </button>
          </div>

          <!--save-->
          <div>
            <button class="button save" onclick=saveToFile()>
              {{translate('save_as')}}
              <span id=save_as_filename>
                "{{Global.General.Name}}.json"
              </span>
            </button>
          </div>

          <!--clear-->
          <div>
            <button class="button delete" onclick=clearSystem() style=margin-left:0>
              {{translate('clear')}}
            </button>
          </div>

          <!--next-->
          <div>
            <button class="button next"
              onclick="event.stopPropagation();ecam.views.show('get_started')"
            >
              {{translate('next')}}
            </button>
          </div>
        </div>
      </div>

      <br><br>

      <div>
        <a class="blue_links" href="http://wacclim.org/" target=_blank>
          WaCCliM
        </a> -
        <a class="blue_links" href=about.php>
          {{translate("about")}}
        </a> -
        <a class="blue_links" href=help.php>
          {{translate("help")}}
        </a> -
        <a class="blue_links" href=mailto:info@wacclim.org target=_blank>
          {{translate("contact")}}: info@wacclim.org
        </a>
      </div>
      <img class="license_img license_img-big" src="img/CC_license_small.png" alt="">
      <br>
      {{translate("ecam_by_iwa_giz_icra")}}
      <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
        {{translate("creative_commons_attr")}}
      </a>.
      <div style=font-size:smaller>
        {{translate("wacclim_is_part_of_IKI")}}
      </div>
    </div>

    <!--picture-->
    <div class="width_50" style="padding:0;text-align:center">
      <img class="img_resp" src="svg/diagram.png">
    </div>
  </div>

  <!--logos-->
  <div>
    <footer id=footer>
      <img
        id=logo-wacclim
        src="img/logo-wacclim_big.png"
      >
    </footer>
    <div style="background:white;text-align:left;padding:0em 10em;margin-top:50px;">
      <img src="img/logos.png">
      <br><img src="img/logo-kwb.png">
    </div>
  </div>
</div>

<!--get started-->
<div id=get-started v-if="visible">
  <h1 style=text-align:center>{{translate('getStarted_subtitle')}}</h1>
  <table style=margin:auto>
    <tr>
      <th>{{translate('getStarted_table_name')}}
      <td><input
        id=Name
        v-model="Global.General.Name"
        @change="updateResult()"
      >
    </tr>
    <tr>
      <th>{{translate('getStarted_table_start')}}
      <td><input type=date
        v-model="Global.General.AssessmentPeriodStart"
        @change="updateResult()"
      >
    </tr>
    <tr>
      <th>{{translate('getStarted_table_end')}}
      <td><input type=date
        v-model="Global.General.AssessmentPeriodEnd"
        @change="updateResult()"
      >
    </tr>
    <tr>
      <th>{{translate('getStarted_table_period')}}
      <td>{{Global.General.Days()}} {{translate('days')}}
    </tr>
    <tr>
      <th>{{translate('currency')}}
      <td>
        <div style="color:black;font-weight:bold">
          {{Global.General.Currency}}
        </div>
        {{translate('configuration_new_currency')}}:
        <input
          v-model="Global.General.Currency"
          size=3 maxlength=3 placeholder="ccc"
          @change="updateResult()"
        >
      </td>
    </tr>
    <tr>
      <th>{{translate('getStarted_table_comments')}}
      <td>
        <textarea
          v-model="Global.General.Comments"
          :placeholder="translate('getStarted_max_200')"
          rows=5 cols=50 maxlength=200
          @change="updateResult()"
        ></textarea>
    </tr>
  </table>

  <!--PREV&NEXT-->
  <div class=flex style="justify-content:center;margin-top:1em">
    <button class="button prev"
      onclick="event.stopPropagation();ecam.views.show('index')">
      {{translate('previous')}}
    </button>
    <button class="button next"
      onclick="event.stopPropagation();ecam.views.show('configuration')">
      {{translate('next')}}
    </button>
  </div>
</div>

<!--configuration-->
<div id=configuration v-if="visible">
  <h1 style=text-align:center>
    {{translate('configuration')}}
  </h1>
  <div class=flex style=justify-content:center>
    <!--configuration left-->
    <div style="max-width:50%">
      <h4 style="margin:0;margin-bottom:1em;text-align:center">
        {{translate('configuration_subtitle')}}
      </h4>
      <table id=select_stages>
        <tr>
          <th>{{translate('quick_assessment')}}
          <th>{{translate('energy_performance')}}
        </tr>
        <tbody v-for="l1 in Structure.filter(l=>l.sublevel==false)">
          <tr>
            <td
              rowspan=4
              :style="Global.Configuration.ActiveStages[l1.alias]?'background:lightgreen':''"
            >
              <label>
                <input type=checkbox
                  v-model="Global.Configuration.ActiveStages[l1.alias]"
                  @change="check_l2_from_l1();updateResult()"
                >
                <img :src="`img/${l1.alias}.png`">
                {{translate(l1.level)}}<br>
              </label>
            </td>
          </tr>
          <tr v-for="l2 in Structure.filter(l=>(l.sublevel && l.level==l1.level))">
            <td
              :style="Global.Configuration.ActiveStages[l2.alias]?'background:lightgreen':''"
            >
              <label>
                <input type=checkbox
                  v-model="Global.Configuration.ActiveStages[l2.alias]"
                  @change="check_l1_from_l2();updateResult()"
                >
                <img :src="`img/${l2.alias}.png`">
                {{translate(l2.sublevel)}}<br>
              </label>
            </td>
          </tr>
        </tbody>
      </table>
      <div style=text-align:center>
        <button
          class=button
          @click="activate_all_stages()"
        >{{translate('configuration_activate_all')}}
        </button>
      </div>
    </div>

    <!--configuration right-->
    <div style="max-width:45%;padding:0em 1em 1em 1em">
      <!--select country-->
      <fieldset>
        <legend>{{translate('select_country')}}
          <select
            v-model="Global.General.Country"
            @change="set_variables_from_selected_country()"
          >
            <option value="false">--select--</option>
            <option v-for="country in Object.keys(Countries)">
              {{country}}
            </option>
          </select>
          <a href="countries.php">Info</a>
        </legend>

        <table>
          <tr>
            <td v-html="translate('conv_kwh_co2_descr')">
            <td>
              <input v-model.number="Global.General.conv_kwh_co2"
                @change="updateResult"
              >
            <td>kg<sub>CO<sub>2</sub></sub>/kWh
          <tr>
            <td v-html="translate('prot_con_descr')">
            <td>
              <input v-model.number="Global.General.prot_con"
                @change="updateResult"
              >
            <td>kg/{{translate('person')}}/{{translate('year')}}
          <tr>
            <td v-html="translate('bod_pday_descr')">
            <td>
              <input v-model.number="Global.General.bod_pday"
                @change="updateResult"
              >
            <td>g/{{translate('person')}}/{{translate('day')}}
          <tr>
            <td v-html="translate('bod_pday_fs_descr')">
            <td>
              <input v-model.number="Global.General.bod_pday_fs"
                @change="updateResult"
              >
            <td>g/{{translate('person')}}/{{translate('day')}}
          </tr>
        </table>
      </fieldset>

      <!--fuel engines in any stage-->
      <fieldset>
        <legend>{{translate('do_you_have_engines')}}
        </legend>
        <label>
          {{translate('no')}}
          <input type=radio
            name=anyFuelEngines
            v-model.number="Global.General.anyFuelEngines"
            value=0
            @change=answerAnyFuelEngines()
          >
        </label> &emsp;
        <label>
          {{translate('yes')}}
          <input type=radio
            name=anyFuelEngines
            v-model.number="Global.General.anyFuelEngines"
            value=1
            @change=answerAnyFuelEngines()
          >
        </label>
      </fieldset>

      <div>
        <!--select assessment report-->
        <fieldset>
          <legend>
            {{translate('select_gwp_source')}}
            <!--select gwp report which defines gwp values-->
            <select
              v-model="Global.Configuration.Selected.gwp_reports_index"
              @change="set_constants_from_gwp_report()"
            >
              <option v-for="report,i in GWP_reports" :value="i">
                {{report.report}}
              </option>
            </select>
            <a href=gwp_table.php>Info</a>
          </legend>

          <!--description of gwp values-->
          <div style="padding:0.5em 0"
            v-html="translate('gwp_values_relative_to')"
          ></div>

          <!--actual gwp values-->
          <table>
            <tr>
              <td>{{translate('carbon_dioxide')}} (CO<sub>2</sub>)
              <td align=right>1
              <td>CO<sub>2</sub> {{translate('equivalents')}}
            <tr>
              <td>{{translate('methane')}} (CH<sub>4</sub>)
              <td align=right>{{Cts.ct_ch4_eq.value}}
              <td>CO<sub>2</sub> {{translate('equivalents')}}
            <tr>
              <td>{{translate('nitrouns_oxide')}} (N<sub>2</sub>O)
              <td align=right>{{Cts.ct_n2o_eq.value}}
              <td>CO<sub>2</sub> {{translate('equivalents')}}
            </tr>
          </table>
        </fieldset>
      </div>
    </div>
  </div>

  <!--prev & next buttons-->
  <div class=flex style="margin:1em;justify-content:center">
    <button class="button prev"
      onclick="event.stopPropagation();ecam.views.show('get_started')">
      {{translate('previous')}}
    </button>
    <button class="button next"
      onclick="event.stopPropagation();ecam.views.show('population')">
      {{translate('next')}}
    </button>
  </div>
</div>

<!--population-->
<div id=population v-if="visible">
  <h1 style="text-align:center">{{translate('population')}}</h1>

  <h4 style="text-align:center;margin:0;margin-bottom:1em">
    {{translate("Enter the population living at each level of your system")}}
  </h4>

  <table style="font-size:16px;margin:auto;width:50%">
    <tbody v-for="l1 in Structure.filter(s=>s.sublevel==false)">
      <tr>
        <th colspan=3 :style=`background:${l1.color};text-align:left`>
        <img :src="`img/${l1.alias}.png`" width=25 style="line-height:4em;vertical-align:middle">
        {{translate(l1.level)}}
      </tr>
      <tr v-if="!Global.Configuration.ActiveStages[l1.alias]">
        <td colspan=3 inactive>{{translate('birds_stage_not_active')}}
      </tr>
      <tr v-else v-for="pop in Population.filter(p=>p.level==l1.level)">
        <td :caption="translate(pop.code+'_expla')">
          {{translate(pop.code+'_descr')}}
        </td>
        <td class=input_container>
          <input
            :value="format(pop.stage[pop.code])"
            @focus="focus_input(pop, $event)"
            @blur="blur_input(pop, $event)"
            :tabindex="Population.indexOf(pop)+1"
            style="text-align:right"
          >
        </td>
        <td><small>{{translate('people')}}</small></td>
      </tr>
    </tbody>
  </table>

  <!--prev next buttons-->
  <div class=flex style="justify-content:center;margin-top:1em">
    <button class="button prev"
      onclick="event.stopPropagation();ecam.views.show('configuration')">
      {{translate('previous')}}
    </button>
    <button class="button next"
      onclick="event.stopPropagation();ecam.views.show('tier_a')">
      {{translate('next')}}
    </button>
  </div>
</div>

<!--tier a TODO-->
<!--tier b TODO-->
<!--summary ghg TODO-->
<!--summary nrg TODO-->
<!--opps TODO-->

<!--load vue components-->
<script src="components.js"></script>

<!--sidebar click listeners-->
<script>
  //click anywhere hides the sidebar
  document.documentElement.addEventListener('click',function(){
    sidebar.visible=false;
  });

  //escape key hides the sidebar
  document.documentElement.addEventListener('keydown',function(e){
    if(e.which==27){ sidebar.visible=false; }
  });
</script>
